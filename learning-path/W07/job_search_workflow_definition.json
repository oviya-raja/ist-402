{
  "name": "Job Search & Fitment Analysis",
  "description": "Job Search & Fitment Analysis Workflow",
  "nodes": [
    {
      "id": "user_input",
      "type": "agent",
      "name": "User Input",
      "config": {
        "system_prompt": "Accept user profile input for job search. Profile should include: skills (array), experience (string), education (string), target_companies (array).",
        "input_schema": {
          "type": "object",
          "properties": {
            "profile": {
              "type": "object",
              "properties": {
                "skills": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                },
                "experience": {
                  "type": "string"
                },
                "education": {
                  "type": "string"
                },
                "target_companies": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              },
              "required": [
                "skills",
                "experience",
                "education"
              ]
            }
          }
        }
      }
    },
    {
      "id": "validate_input",
      "type": "if_else",
      "name": "Validate Input",
      "config": {
        "condition": "profile.skills && profile.experience && profile.education",
        "true_path": "load_companies",
        "false_path": "error_end"
      }
    },
    {
      "id": "load_companies",
      "type": "transform",
      "name": "Load Companies",
      "config": {
        "operation": "read_csv",
        "file": "target-companies.csv",
        "filter": {
          "status": "active"
        }
      }
    },
    {
      "id": "search_job_sites",
      "type": "tool",
      "name": "Search Job Sites",
      "config": {
        "tool_type": "web_scraper",
        "targets": "{{load_companies.output.careers_url}}"
      }
    },
    {
      "id": "jobs_found_check",
      "type": "if_else",
      "name": "Jobs Found?",
      "config": {
        "condition": "search_job_sites.output.jobs.length > 0",
        "true_path": "extract_job_details",
        "false_path": "no_results_end"
      }
    },
    {
      "id": "extract_job_details",
      "type": "transform",
      "name": "Extract Job Details",
      "config": {
        "operation": "parse_job_postings",
        "fields": [
          "title",
          "description",
          "requirements",
          "skills",
          "location"
        ]
      }
    },
    {
      "id": "analyze_profile_match",
      "type": "agent",
      "name": "Analyze Profile Match",
      "config": {
        "system_prompt": "You are a Job Fitment Analysis Agent. Analyze job postings against student profiles. Calculate fitment percentages based on skills, experience, and education matches. Return structured analysis with matched skills, gaps, and fitment score.",
        "input": "{{extract_job_details.output}} + {{user_input.output.profile}}"
      }
    },
    {
      "id": "calculate_fitment",
      "type": "transform",
      "name": "Calculate Fitment",
      "config": {
        "formula": "(matched_required_skills * 0.4) + (matched_preferred_skills * 0.2) + (experience_match * 0.2) + (education_match * 0.2)"
      }
    },
    {
      "id": "identify_skill_gaps",
      "type": "transform",
      "name": "Identify Skill Gaps",
      "config": {
        "operation": "compare_skills",
        "required": "{{extract_job_details.output.required_skills}}",
        "user": "{{user_input.output.profile.skills}}"
      }
    },
    {
      "id": "rank_results",
      "type": "transform",
      "name": "Rank Results",
      "config": {
        "operation": "sort",
        "by": "fitment_percentage",
        "order": "desc",
        "limit": 10,
        "priority_boost": 0.1
      }
    },
    {
      "id": "end",
      "type": "end",
      "name": "End",
      "config": {
        "output_format": "json",
        "output": {
          "jobs": "{{rank_results.output}}",
          "fitment_scores": "{{calculate_fitment.output}}",
          "skill_gaps": "{{identify_skill_gaps.output}}"
        }
      }
    }
  ],
  "edges": [
    {
      "from": "user_input",
      "to": "validate_input"
    },
    {
      "from": "validate_input",
      "to": "load_companies",
      "condition": "true"
    },
    {
      "from": "validate_input",
      "to": "error_end",
      "condition": "false"
    },
    {
      "from": "load_companies",
      "to": "search_job_sites"
    },
    {
      "from": "search_job_sites",
      "to": "jobs_found_check"
    },
    {
      "from": "jobs_found_check",
      "to": "extract_job_details",
      "condition": "true"
    },
    {
      "from": "jobs_found_check",
      "to": "no_results_end",
      "condition": "false"
    },
    {
      "from": "extract_job_details",
      "to": "analyze_profile_match"
    },
    {
      "from": "analyze_profile_match",
      "to": "calculate_fitment"
    },
    {
      "from": "calculate_fitment",
      "to": "identify_skill_gaps"
    },
    {
      "from": "identify_skill_gaps",
      "to": "rank_results"
    },
    {
      "from": "rank_results",
      "to": "end"
    }
  ]
}