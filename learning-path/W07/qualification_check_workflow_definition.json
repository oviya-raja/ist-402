{
  "name": "Job Qualification Check",
  "description": "Job Qualification Check Workflow",
  "nodes": [
    {
      "id": "job_url_input",
      "type": "agent",
      "name": "Job URL Input",
      "config": {
        "system_prompt": "Accept job posting URL and user profile for qualification check.",
        "input_schema": {
          "type": "object",
          "properties": {
            "job_url": {
              "type": "string",
              "format": "uri"
            },
            "profile": {
              "type": "object"
            }
          },
          "required": [
            "job_url",
            "profile"
          ]
        }
      }
    },
    {
      "id": "validate_url",
      "type": "if_else",
      "name": "Validate URL",
      "config": {
        "condition": "is_valid_url(job_url_input.output.job_url) && job_url_input.output.profile",
        "true_path": "access_job_posting",
        "false_path": "error_end"
      }
    },
    {
      "id": "access_job_posting",
      "type": "tool",
      "name": "Access Job Posting",
      "config": {
        "tool_type": "web_scraper",
        "url": "{{job_url_input.output.job_url}}"
      }
    },
    {
      "id": "posting_accessible",
      "type": "if_else",
      "name": "Posting Accessible?",
      "config": {
        "condition": "access_job_posting.output.status === 'success'",
        "true_path": "extract_requirements",
        "false_path": "access_error_end"
      }
    },
    {
      "id": "extract_requirements",
      "type": "transform",
      "name": "Extract Requirements",
      "config": {
        "operation": "parse_job_posting",
        "fields": [
          "required_skills",
          "preferred_skills",
          "experience",
          "education"
        ]
      }
    },
    {
      "id": "load_user_profile",
      "type": "transform",
      "name": "Load User Profile",
      "config": {
        "operation": "load_from_kb",
        "profile_id": "{{job_url_input.output.profile.id}}"
      }
    },
    {
      "id": "compare_requirements",
      "type": "agent",
      "name": "Compare Requirements",
      "config": {
        "system_prompt": "Compare job requirements against user profile. Identify matched skills, missing qualifications, and calculate fitment percentage.",
        "input": "{{extract_requirements.output}} + {{load_user_profile.output}}"
      }
    },
    {
      "id": "calculate_fitment",
      "type": "transform",
      "name": "Calculate Fitment",
      "config": {
        "formula": "(matched_required * 0.4) + (matched_preferred * 0.2) + (experience * 0.2) + (education * 0.2)"
      }
    },
    {
      "id": "identify_matches",
      "type": "transform",
      "name": "Identify Matches",
      "config": {
        "operation": "list_matches",
        "source": "{{compare_requirements.output}}"
      }
    },
    {
      "id": "identify_gaps",
      "type": "transform",
      "name": "Identify Gaps",
      "config": {
        "operation": "list_gaps",
        "source": "{{compare_requirements.output}}"
      }
    },
    {
      "id": "generate_recommendation",
      "type": "if_else",
      "name": "Generate Recommendation",
      "config": {
        "condition": "calculate_fitment.output.fitment_percentage",
        "branches": [
          {
            "condition": ">= 80",
            "path": "recommend_apply"
          },
          {
            "condition": ">= 60",
            "path": "recommend_consider"
          },
          {
            "condition": "< 60",
            "path": "recommend_improve"
          }
        ]
      }
    },
    {
      "id": "end",
      "type": "end",
      "name": "End",
      "config": {
        "output_format": "json",
        "output": {
          "fitment_percentage": "{{calculate_fitment.output.fitment_percentage}}",
          "matched_skills": "{{identify_matches.output}}",
          "missing_skills": "{{identify_gaps.output}}",
          "recommendation": "{{generate_recommendation.output}}"
        }
      }
    }
  ],
  "edges": [
    {
      "from": "job_url_input",
      "to": "validate_url"
    },
    {
      "from": "validate_url",
      "to": "access_job_posting",
      "condition": "true"
    },
    {
      "from": "validate_url",
      "to": "error_end",
      "condition": "false"
    },
    {
      "from": "access_job_posting",
      "to": "posting_accessible"
    },
    {
      "from": "posting_accessible",
      "to": "extract_requirements",
      "condition": "true"
    },
    {
      "from": "posting_accessible",
      "to": "access_error_end",
      "condition": "false"
    },
    {
      "from": "extract_requirements",
      "to": "load_user_profile"
    },
    {
      "from": "load_user_profile",
      "to": "compare_requirements"
    },
    {
      "from": "compare_requirements",
      "to": "calculate_fitment"
    },
    {
      "from": "calculate_fitment",
      "to": "identify_matches"
    },
    {
      "from": "identify_matches",
      "to": "identify_gaps"
    },
    {
      "from": "identify_gaps",
      "to": "generate_recommendation"
    },
    {
      "from": "generate_recommendation",
      "to": "end"
    }
  ]
}